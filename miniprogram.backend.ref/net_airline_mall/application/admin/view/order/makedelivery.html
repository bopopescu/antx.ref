<!DOCTYPE html>
<html lang="zh-CN">
{include file="public:head"}
<style>.order_total .section dl {
    width: 20%;
}</style>
<body class="iframe_body">
<div class="warpper" id="app" v-cloak>
    <div class="content">
        <div class="flexilist order_info">
            <div class="common-content">
                <!--订单基本信息-->
                <div class="step">
                    <div class="step_title">
                        <i class="ui-step"></i>
                        <h3>基本信息</h3>
                    </div>
                    <div class="section">
                        <dl>
                            <dt>订单号：</dt>
                            <dd>{{info.order.order_sn}}</dd>
                            <dt>订单来源：</dt>
                            <dd>PC</dd>
                        </dl>
                        <dl>
                            <dt>
                                收货人：
                                <div class="div_a">
                                    <a href="javascript:void(0);" @click="userinfo()">信息</a>
                                </div>
                            </dt>
                            <dd>{{info.order.mobile}}</dd>
                            <dt>订单状态：</dt>
                            <dd>
                                <span v-if="info.order.order_status==0">待确认</span>
                                <span v-else-if="info.order.order_status==1">已确认</span>
                                <span v-else-if="info.order.order_status==2">待评价</span>
                                <span v-else-if="info.order.order_status==3">已取消</span>
                                <span v-else-if="info.order.order_status==4">已完成</span>
                                <span v-else-if="info.order.order_status==5">退款</span>
                                <span v-else-if="info.order.order_status==6">无效</span>,
                                <span v-if="info.order.pay_status==0">待付款</span>
                                <span v-else>已付款</span>,
                                <span v-if="info.order.shipping_status==0">待发货</span>
                                <span v-if="info.order.shipping_status==1">发货中</span>
                                <span v-if="info.order.shipping_status==2">已发货</span>
                                <span v-if="info.order.shipping_status==3">部分发货</span>
                            </dd>
                        </dl>
                        <dl>
                            <dt>支付方式：</dt>
                            <dd>{{info.order.pay_name}}</dd>
                            <dt>
                                &nbsp;
                            </dt>
                            <dd>
                                &nbsp;
                            </dd>
                        </dl>
                        <dl style="width:30%">
                            <dt>下单时间：</dt>
                            <dd>{{info.order.add_time|timeParse}}</dd>
                            <dt>付款时间：</dt>
                            <dd>{{info.order.pay_time|timeParse}}</dd>
                        </dl>
                        <dl style="width:20%">
                            <dt>&nbsp;</dt>
                            <dd>&nbsp;</dd>
                            <dt>&nbsp;</dt>
                            <dd>&nbsp;</dd>
                        </dl>
                    </div>
                </div>
                <!--收货信息-->
                <div class="step">
                    <div class="step_title"><i class="ui-step"></i>
                        <h3>收货人信息
                            <a href="javascript:void(0)" @click="addressinfo()">
                                <i class="icon icon-edit"></i>
                            </a>
                        </h3>
                    </div>
                    <div class="section">
                        <dl>
                            <dt>收货人：</dt>
                            <dd>{{info.order.consignee}}</dd>
                        </dl>
                        <dl>
                            <dt>手机号码：</dt>
                            <dd>{{info.order.mobile}}</dd>

                        </dl>
                        <dl style="width:66.6%">
                            <dt>收货地址：</dt>
                            <dd>{{info.order.addressTemp}}</dd>
                        </dl>
                    </div>
                </div>
                <!--订单其他信息-->
                <div class="step">
                    <div class="step_title">
                        <i class="ui-step"></i>
                        <h3>
                            其他信息
                            <a href="javascript:void(0)" @click="invoiceInit()">
                                <i class="icon icon-edit"></i>
                            </a>
                        </h3>
                    </div>
                    <div class="section">
                        <dl>
                            <dt>发票类型：</dt>
                            <dd>{{info.order.invoice_type==0?'普通发票':'增值税发票'}}</dd>
                            <dt>发票内容：</dt>
                            <dd>{{info.order.invoice_content}}</dd>
                        </dl>
                        <dl>
                            <dt>&nbsp;</dt>
                            <dd>&nbsp;</dd>
                            <dt>&nbsp;</dt>
                            <dd>&nbsp;</dd>
                        </dl>
                        <dl style="width:66.6%">
                            <dt>卖家留言：</dt>
                            <dd>{{info.order.admin_note}}</dd>
                            <dt>买家留言：</dt>
                            <dd>{{info.order.user_note}}</dd>
                        </dl>
                    </div>
                </div>
                <!--商品信息-->
                <div class="step">
                    <div class="step_title">
                        <i class="ui-step"></i>
                        <h3>商品信息</h3>
                    </div>
                    <div class="step_info">
                        <div class="order_goods_fr">
                            <table class="table" border="0" cellpadding="0" cellspacing="0">
                                <thead>
                                <tr>
                                    <th width="20%" class="first">商品名称</th>
                                    <th width="10%">货号</th>


                                    <th width="10%">价格</th>
                                    <th width="10%">商品赠送积分</th>
                                    <th width="5%">数量</th>
                                    <th width="10%">发货数量</th>

                                    <th width="5%">库存</th>
                                    <th width="5%">小计</th>
                                    <th width="10%">操作</th>
                                </tr>
                                </thead>
                                <tbody>
                                <template v-for="(vo2,index) in info.goods_list">
                                    <tr>
                                        <td>
                                            <div class="order_goods_div">
                                                <div class="img">
                                                    <a :href="'/home/goods/detail?id='+vo2.goods_id" target="_blank">
                                                        <img :src="vo2.goods_img" width="72" height="72"/>
                                                    </a>
                                                </div>
                                                <div class="name ml10">
                                                    <a :href="'/home/goods/detail?id='+vo2.goods_id" target="_blank">{{vo2.goods_name}}</a>
                                                </div>
                                            </div>
                                        </td>
                                        <td>{{vo2.goods_sn}}</td>
                                        <td><em>¥</em>{{vo2.goods_price}}</td>
                                        <td>{{vo2.integral}}</td>
                                        <td>{{vo2.goods_num}}</td>
                                        <td>
                                            <input type="number" class="text" v-model="vo2.send_num" placeholder="请填写发货数量"></td>
                                        <td>{{vo2.goods_number}}</td>
                                        <td><em>¥</em>{{vo2.goods_price*vo2.goods_num}}</td>
                                        <td v-if="index==0">
                                            <!--
                                            * table order
                                            * order_status：订单状态  0:待确认 1:已确认 2:待评价 3:已取消 4:已完成 5:退款 6:作废
                                            * pay_status：0待支付，1已付款
                                            * shipping_status: 发货状态  0：未发货 1：已发货 2：部分发货，3：已签收
                                            *
                                            -->
                                            <!--                                            <template v-if="info.order.order_status==0">-->
                                            <!--                                                <input name="part_to_delivery" type="button" value="确认订单"-->
                                            <!--                                                       class="btn btn25 blue_btn" @click="orderUpstatus(1,0)"/>-->
                                            <!--                                            </template>-->
                                            <!--                                            <template v-if="info.order.shipping_status==0&&info.order.order_status==1">-->
                                            <!--                                                <input name="part_to_delivery" type="button" value="去发货"-->
                                            <!--                                                       @click="orderUpstatus(1,1)"-->
                                            <!--                                                       class="btn btn25 blue_btn"/>-->
                                            <!--                                            </template>-->
                                            <!--                                            <template v-if="info.order.shipping_status==1">-->
                                            <!--                                                <input name="part_to_delivery" type="button" value="去签收"-->
                                            <!--                                                       @click="orderUpstatus(1,3)"-->
                                            <!--                                                       class="btn btn25 blue_btn"/>-->
                                            <!--                                            </template>-->
                                            <!--                                            <template v-if="info.order.shipping_status==3&&info.order.order_status==1">-->
                                            <!--                                                <input name="part_to_delivery" type="button" value="完成"-->
                                            <!--                                                       @click="orderUpstatus(4,3)"-->
                                            <!--                                                       class="btn btn25 blue_btn"/>-->
                                            <!--                                            </template>-->
                                            <!--                                            <template v-if="info.order.shipping_status==3&&info.order.order_status==4">-->
                                            <!--                                                <input name="part_to_delivery" type="button" value="已完成"-->
                                            <!--                                                       class="btn btn25 blue_btn"/>-->
                                            <!--                                            </template>-->
                                            <!--                                            <input name="part_to_delivery" type="button" value="作废"-->
                                            <!--                                                   @click="orderUpstatus(6,0)"-->
                                            <!--                                                   class="btn btn25 red_btn"/>-->
                                        </td>
                                    </tr>
                                </template>

                                <tr>
                                    <td colspan="12">
                                        <div class="order_total_fr">
                                            <strong>合计：</strong>
                                            <span class="red">
                                            <em>¥</em>
                                            {{info.order.goods_price}}
                                            </span>
                                        </div>
                                    </td>
                                </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
                <!--费用信息-->
                <div class="step order_total hide">
                    <div class="step_title">
                        <i class="ui-step"></i>
                        <h3>费用信息
                            <template v-if="info.order.order_status!=1">
                                <a href="javascript:void(0)" @click="priceupdateInit()">
                                    <i class="icon icon-edit"></i>
                                </a>
                            </template>
                        </h3>
                    </div>
                    <div class="section">
                        <dl>
                            <dt>商品总金额：</dt>
                            <dd>
                                <em>¥</em>
                                {{info.order.goods_price}}
                            </dd>
                            <dt>使用余额：</dt>
                            <dd>
                                - <em>¥</em>
                                {{info.order.user_money}}
                            </dd>
                        </dl>
                        <dl>
                            <dt>发票税额：</dt>
                            <dd>
                                + <em>¥</em>
                                0.00
                            </dd>
                            <dt>使用积分：</dt>
                            <dd>
                                - <em>¥</em>
                                {{info.order.integral}}
                            </dd>
                        </dl>
                        <dl>
                            <dt>配送费用：</dt>
                            <dd>
                                + <em>¥</em>
                                {{info.order.shipping_price}}
                            </dd>
                            <dt>支付费用：</dt>
                            <dd>
                                <template v-if="info.order.pay_status==1">
                                    + <em>¥</em>{{info.order.order_amount}}
                                </template>
                                <template v-else>
                                    <span class="red">未支付</span>
                                </template>
                            </dd>
                        </dl>
                        <dl>
                            <dt>使用优惠券：</dt>
                            <dd>
                                - <em>¥</em>
                                {{info.order.coupon_price}}
                            </dd>
                            <dt>已付款金额：</dt>
                            <dd>
                                - <em>¥</em>
                                {{info.order.order_amount}}
                            </dd>
                        </dl>
                        <dl>
                            <dt>订单总金额：</dt>
                            <dd class="red">
                                <em>¥</em>
                                {{info.order.total_amount}}

                            </dd>
                            <dt>应付款金额：</dt>
                            <dd class="red">
                                <em>¥</em>
                                {{info.order.order_amount}}
                            </dd>
                        </dl>
                    </div>
                </div>
                <!--操作信息-->
                <div class="step order_total">
                    <div class="step_title">
                        <i class="ui-step"></i>
                        <h3>操作信息</h3>
                    </div>
                    <div class="step_info">
                        <div class="order_operation order_operation100">
                            <div class="item">
                                <div class="label">操作备注：</div>
                                <div class="value">
                                    <div class="bf100 fl">
                                        <textarea name="action_note" class="textarea"
                                                  v-model="action_remark"></textarea>
                                    </div>
                                    <div class="order_operation_btn">
                                        <input name="delivery_confirmed" type="submit" value="确认生成发货单"
                                               class="btn btn25 red_btn" @click="makedelivery(1)">
                                        <input name="delivery_confirmed" type="submit" value="取消"
                                               class="btn btn25 red_btn" @click="makedelivery(0)">
                                    </div>
                                </div>
                            </div>
                        </div>
                        <div class="operation_record">
                            <table cellpadding="0" cellspacing="0">
                                <thead>
                                <th width="5%">&nbsp;</th>
                                <th width="15%">操作者</th>
                                <th width="15%">操作时间</th>
                                <th width="15%">订单状态</th>
                                <th width="15%">付款状态</th>
                                <th width="15%">发货状态</th>
                                <th width="20%">备注</th>
                                </thead>
                                <tbody>
                                <template v-for="(vo,index) in info.order_log">
                                    <tr>
                                        <td>&nbsp;</td>
                                        <td>{{vo.action_user_name}}</td>
                                        <td>{{vo.log_time|timeParse}}</td>
                                        <td>{{vo.status_desc}}</td>
                                        <td>
                                            {{vo.pay_status>0?'已付款':'未付款'}}
                                        </td>
                                        <td>
                                            <template v-if="info.order.shipping_status==0">未发货</template>
                                            <template v-if="info.order.shipping_status==1">已发货</template>
                                            <template v-if="info.order.shipping_status==2">部分发货</template>
                                            <template v-if="info.order.shipping_status==3">已签收</template>
                                        </td>
                                        <td><p v-html="vo.action_remark"></p></td>
                                    </tr>
                                </template>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="operate_form">
        <div id="order_goods_layer" style="display:none;">
            <div class="brank_s"></div>
            <div class="delivery_content">
                <div class="items">
                    <div class="item">
                        <div class="label">收货人：</div>
                        <div class="value">{{info.order.consignee}}</div>
                    </div>
                    <div class="item">
                        <div class="label">手机号码：</div>
                        <div class="value">{{info.order.mobile}}</div>
                    </div>
                    <div class="item">
                        <div class="label">收货地址：</div>
                        <div class="value">{{info.order.addressTemp}}</div>
                    </div>
                    <div class="item">
                        <div class="label ftx-02"><em class="require-field">*</em>发货单号：</div>
                        <div class="value">
                            <input type="text" name="invoice_no" id="invoice_no" class="text mr0" autocomplete="off">
                            <input type="submit" name="to_shipping" value="发货" class="btn btn25 blue_btn w60 tc"
                                   id="invoice_btn">
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="userinfo" class="hide">
        <div class="layui-card">
            <div class="layui-card-header">用户基本信息</div>
            <div class="layui-card-body">
                <table class="layui-table" lay-size="sm">
                    <thead>
                    <tr>
                        <th>联系电话</th>
                        <th>用户名</th>
                        <th>用户昵称</th>
                        <th>账户余额</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>{{info.user.mobile}}</td>
                        <td>{{info.user.user_name}}</td>
                        <td>{{info.user.nick_name}}</td>
                        <td>{{info.user.user_money}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
        <div class="layui-card">
            <div class="layui-card-header">收货地址基本信息</div>
            <div class="layui-card-body">
                <table class="layui-table" lay-size="sm">
                    <thead>
                    <tr>
                        <th>收货人</th>
                        <th>邮编</th>
                        <th>电话</th>
                        <th>地址</th>
                    </tr>
                    </thead>
                    <tbody>
                    <tr>
                        <td>{{info.order.consignee}}</td>
                        <td>{{info.order.zipcode}}</td>
                        <td>{{info.order.mobile}}</td>
                        <td>{{info.order.address}}</td>
                    </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <div id="invoice" class="hide">
        <div class="layui-col-md10">
            <div class="layui-card">
                <div class="layui-card-body">
                    <div class="layui-form-item">
                        <label class="layui-form-label">发票类型：</label>
                        <div class="layui-input-block">
                            <input type="radio" id="one" value="0" v-model="info.order.invoice_type">
                            <label for="one">普通发票</label>

                            <input type="radio" id="two" value="1" v-model="info.order.invoice_type">
                            <label for="two">增值税发票</label>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">发票抬头：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.invoice_title" lay-verify="required"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">发票税号：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.invoice_no" lay-verify="required"
                                   class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">发票内容：</label>
                        <div class="layui-input-block">
                            <textarea name="other" class="layui-textarea"
                                      v-model="info.order.invoice_content"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">买家留言：</label>
                        <div class="layui-input-block">
                            <textarea name="other" class="layui-textarea" v-model="info.order.user_note"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">商家给客户的留言：</label>
                        <div class="layui-input-block">
                            <textarea name="other" class="layui-textarea" v-model="info.order.admin_note"></textarea>
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-sm" lay-filter="component-form-element"
                                    @click="doupdate('invoice')">
                                提交
                            </button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="priceupdate" class="hide">
        <div class="layui-col-md10">
            <div class="layui-card">
                <div class="layui-card-body">

                    <div class="layui-form-item">
                        <label class="layui-form-label">商品总金额：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.goods_price" lay-verify="required"
                                   class="layui-input" disabled>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">使用余额：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.user_money" lay-verify="required" class="layui-input"
                                   disabled>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">使用积分：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.integral" lay-verify="required" class="layui-input"
                                   disabled>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">订单活动优惠：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.order_prom_amount" lay-verify="required"
                                   class="layui-input" disabled>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">配送费用：</label>
                        <div class="layui-input-block">
                            <input type="number" v-model="info.order.shipping_price" lay-verify="required"
                                   class="layui-input" @change="calc_price('shipping_price')">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">(+-)价格调整：</label>
                        <div class="layui-input-block">
                            <input type="number" v-model="info.order.discount" lay-verify="required" class="layui-input"
                                   @change="calc_price('discount')">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">订单总金额：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.total_amount" lay-verify="required"
                                   class="layui-input" disabled>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">应付款金额：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.order_amount" lay-verify="required"
                                   class="layui-input" disabled>
                        </div>
                    </div>

                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-sm" lay-filter="component-form-element"
                                    @click="doupdate('priceupdate')">
                                提交
                            </button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="usernote" class="hide">
        <div class="layui-col-md10">
            <div class="layui-card">
                <div class="layui-card-body">
                    <div class="layui-form-item">
                        <label class="layui-form-label">用户备注：</label>
                        <div class="layui-input-block">
                        <textarea name="other" placeholder="" class="layui-textarea"
                                  v-model="info.order.user_note"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">管理员备注：</label>
                        <div class="layui-input-block">
                        <textarea name="other" placeholder="" class="layui-textarea"
                                  v-model="info.order.admin_note"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-sm" lay-filter="component-form-element"
                                    @click="doupdate('usernote')">
                                提交
                            </button>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
    <div id="addressinfo" class="hide">
        <div class="layui-col-md10">
            <div class="layui-card">
                <div class="layui-card-body">

                    <div class="layui-form-item">
                        <label class="layui-form-label">收货人：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.consignee" lay-verify="required" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">手机号：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.mobile" lay-verify="required" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">邮件：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.email" lay-verify="required" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">邮编：</label>
                        <div class="layui-input-block">
                            <input type="text" v-model="info.order.zipcode" lay-verify="required" class="layui-input">
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <label class="layui-form-label">详细地址：</label>
                        <div class="layui-input-block">
                        <textarea name="other" placeholder="" class="layui-textarea"
                                  v-model="info.order.address"></textarea>
                        </div>
                    </div>
                    <div class="layui-form-item">
                        <div class="layui-input-block">
                            <button class="layui-btn layui-btn-sm" lay-filter="component-form-element"
                                    @click="doupdate('addressinfo')">
                                提交
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

</div>

<script>
    var order_id = '{$order_id}';
    var vm = new Vue({
        el: '#app',
        data: {
            order_id: order_id,
            info: [],
            action_remark: '',
        },
        filters: {
            timeParse: function (timestamp) {
                return moment.unix(timestamp).format('YYYY-MM-DD HH:mm:ss');
            }
        },
        methods: {
            makedelivery: function (index) {
                if (index == 0) {
                    parentTabClose();
                } else {
                    let check = 0;
                    vm.info.goods_list.forEach(function (v, i) {
                        if (v.send_num == 0) {
                            check++;
                        }
                    });
                    if (check == vm.info.goods_list.length) {
                        layer.msg('至少选择一件商品生成发货单');
                        return;
                    }

                    $.post('/admin/order/makedelivery', {
                        order_id: vm.order_id,
                        action_remark: vm.action_remark,
                        goods: JSON.stringify(vm.info.goods_list)
                    }, function (ret) {
                        if (ret.status == 1) {
                            $.messager.show({title: '提示', msg: ret.msg, timeout: 3000, showType: 'slide'});
                            localStorage.setItem('refreshOrder', 'true');
                            parentTabClose();
                        } else {
                            $.messager.alert('提示', ret.msg, 'warning');
                        }
                    }, 'json');
                }
            },
            doupdate: function (win) {
                majax("/admin/order/doupdate", vm.info.order, 'order', win);
                setTimeout(function () {
                    vm.init();
                }, 1000);
            },
            calc_price: function (flag) {
                var price = vm.info.order[flag];
                flag = flag == 'discount' ? 'shipping_price' : 'discount';
                price = parseFloat(price) + parseFloat(vm.info.order[flag]);
                vm.info.order.order_amount = (parseFloat(vm.info.order.origin_order_amount) + price).toFixed(2);
            },
            priceupdateInit: function () {
                $('#priceupdate').window({
                    title: '更改订单价格',
                    width: 800,
                    height: 600,
                    modal: true,
                });
            },

            invoiceInit: function () {
                $('#invoice').window({
                    title: '更改发票信息',
                    width: 800,
                    height: 600,
                    modal: true,
                });
            },
            usernote: function () {
                $('#usernote').window({
                    title: '添加备注',
                    width: 800,
                    height: 600,
                    modal: true,
                });
            },
            userinfo: function () {
                $('#userinfo').window({
                    title: '详细信息',
                    width: 800,
                    height: 600,
                    modal: true,
                });
            },
            addressinfo: function () {
                $('#addressinfo').window({
                    title: '详细信息',
                    width: 800,
                    height: 600,
                    modal: true,
                });
            },
            init: function () {
                layer.load(2, {shade: [0.3, '#fff']});
                $.post('/admin/order/orderdetail', {
                    order_id: vm.order_id
                }, function (ret) {
                    vm.info = ret.data;
                    layer.closeAll();

                    setTimeout(function () {
                        //移动到一键发货悬浮展示详情方法调用
                        if ($(".step").width() < 1380) {
                            var left = -420;
                        }
                        orderLevitate("one_delivery", "order_goods_layer", 12.5, left);
                    }, 150);

                }, 'json');
            },
            orderUpstatus: function (order_status, shipping_status) {
                if (typeof order_status == 'undefined') {
                    return false;
                }
                if (typeof shipping_status == 'undefined') {
                    return false;
                }
                $.post('/admin/order/orderUpstatus', {
                    order_id: vm.order_id,
                    order_status: order_status,
                    shipping_status: shipping_status,
                }, function (ret) {
                    if (ret.status == 1) {
                        vm.init();
                    }
                }, 'json');
            }
        },
    });
    $(function () {
        vm.init();
    });
</script>
</body>
</html>
